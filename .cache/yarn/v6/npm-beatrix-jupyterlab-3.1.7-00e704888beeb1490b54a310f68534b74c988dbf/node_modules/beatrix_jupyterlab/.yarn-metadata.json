{
  "manifest": {
    "name": "beatrix_jupyterlab",
    "private": true,
    "version": "3.1.7",
    "description": "Beatrix JupyterLab",
    "keywords": [
      "jupyter",
      "jupyterlab",
      "jupyterlab-extension"
    ],
    "license": "Apache-2.0",
    "author": {
      "name": "Vertex AI Notebooks FE Team"
    },
    "files": [
      "lib/**/*.{d.ts,eot,gif,html,jpg,js,js.map,json,png,svg,woff2,ttf}",
      "schema/settings.json",
      "style/**/*.{css,eot,gif,html,jpg,json,png,svg,woff2,ttf}"
    ],
    "main": "lib/index.js",
    "types": "lib/index.d.ts",
    "style": "style/index.css",
    "scripts": {
      "build": "tsc -p tsconfig.prod.json",
      "build:strict": "tsc -p tsconfig.prod.strict.json",
      "clean": "rimraf build coverage dist *egg-info lib *tsbuildinfo *tgz",
      "develop": "METADATA_SERVER='http://localhost:8889' concurrently -c red,green,yellow \"npm:watch\" \"npm:metadata\" \"npm:devserver\"",
      "devserver": "pipenv run jupyter lab --watch --no-browser --LabApp.token='' --LabApp.password=''",
      "lint-warnings": "eslint \"src/**/*.{ts,tsx}\"",
      "lint": "npm run lint-warnings -- --fix --quiet",
      "metadata": "pipenv run python metadata_server.py vm_metadata.json",
      "prepare": "npm run clean && npm run build",
      "pretest": "npm run lint",
      "prepytest": "npm run pylint",
      "pylint": "find . -type f -name \"*.py\" | xargs pipenv run pylint --rcfile \".pylintrc\" || true",
      "pytest": "pipenv run python -m unittest discover -p '*_test.py'",
      "start": "npm run watch",
      "test": "TZ=UTC jest --coverage",
      "test:watch": "TZ=UTC jest --watch",
      "test:e2e": "jest -c jest-puppeteer.config.js",
      "watch": "tsc -b -w --preserveWatchOutput"
    },
    "dependencies": {
      "@jupyterlab/application": "~3.2.1",
      "@jupyterlab/apputils": "~3.2.1",
      "@jupyterlab/cells": "~3.2.1",
      "@jupyterlab/codemirror": "~3.2.1",
      "@jupyterlab/coreutils": "~5.2.1",
      "@jupyterlab/docmanager": "~3.2.1",
      "@jupyterlab/docregistry": "~3.2.1",
      "@jupyterlab/filebrowser": "~3.2.1",
      "@jupyterlab/launcher": "~3.2.1",
      "@jupyterlab/nbformat": "~3.2.1",
      "@jupyterlab/notebook": "~3.2.1",
      "@jupyterlab/services": "~6.2.1",
      "@jupyterlab/statusbar": "~3.2.1",
      "@jupyterlab/ui-components": "~3.2.1",
      "@lumino/algorithm": "~1.9.0",
      "@lumino/commands": "~1.18.0",
      "@lumino/coreutils": "~1.11.0",
      "@lumino/disposable": "~1.10.0",
      "@lumino/dragdrop": "~1.13.0",
      "@lumino/messaging": "~1.10.0",
      "@lumino/signaling": "~1.10.0",
      "@lumino/widgets": "~1.29.0",
      "@material-ui/core": "~4.12.3",
      "@material-ui/icons": "~4.11.2",
      "@material-ui/lab": "4.0.0-alpha.60",
      "@reduxjs/toolkit": "~1.6.1",
      "buffer": "^6.0.3",
      "copy-to-clipboard": "~3.3.1",
      "csstips": "~1.2.0",
      "date-fns": "~2.23.0",
      "formik": "~2.2.9",
      "jest-mock-extended": "^2.0.4",
      "luxon": "~2.0.2",
      "material-table": "1.69.3",
      "react": "~17.0.2",
      "react-dom": "~17.0.2",
      "react-redux": "~7.2.5",
      "react-resize-detector": "~6.7.6",
      "react-syntax-highlighter": "^15.4.4",
      "recharts": "~2.1.2",
      "redux": "~4.1.1",
      "typestyle": "~2.1.0"
    },
    "devDependencies": {
      "@babel/core": "~7.15.5",
      "@babel/preset-env": "~7.15.6",
      "@jupyterlab/testutils": "~3.2.1",
      "@testing-library/react": "^12.0.0",
      "@types/enzyme": "~3.10.9",
      "@types/expect-puppeteer": "~4.4.6",
      "@types/gapi": "0.0.41",
      "@types/gapi.auth2": "0.0.55",
      "@types/gapi.client.compute": "~1.0.2",
      "@types/gapi.client.servicemanagement": "~1.0.3",
      "@types/jest": "~26.0.15",
      "@types/jest-environment-puppeteer": "~4.4.1",
      "@types/luxon": "^2.0.5",
      "@types/puppeteer": "~5.4.4",
      "@types/react": "~17.0.20",
      "@types/react-dom": "~17.0.9",
      "@types/react-syntax-highlighter": "^13.5.2",
      "@typescript-eslint/eslint-plugin": "~4.31.0",
      "@typescript-eslint/parser": "~4.31.0",
      "@wojtekmaj/enzyme-adapter-react-17": "^0.6.3",
      "concurrently": "~6.2.1",
      "enzyme": "~3.11.0",
      "enzyme-to-json": "~3.6.2",
      "eslint": "~7.32.0",
      "eslint-config-prettier": "~8.3.0",
      "eslint-plugin-prettier": "~3.4.0",
      "expect-puppeteer": "~5.0.4",
      "jest": "~26.6.3",
      "jest-canvas-mock": "~2.3.1",
      "jest-junit": "~10.0.0",
      "jest-puppeteer": "~5.0.4",
      "jest-react-hooks-shallow": "^1.5.1",
      "nodemon": "~2.0.12",
      "prettier": "~2.4.0",
      "puppeteer": "^10.4.0",
      "rimraf": "~3.0.2",
      "ts-jest": "~26.4.4",
      "typescript": "~4.3.5"
    },
    "jupyterlab": {
      "extension": true,
      "schemaDir": "schema",
      "disabledExtensions": [
        "@jupyterlab/apputils-extension:connectionlost"
      ]
    },
    "optionalDependencies": {
      "fsevents": "^2.3.2"
    },
    "_registry": "npm",
    "_loc": "/home/jupyter/.cache/yarn/v6/.tmp/3eeb0851228c5a858a1fe0d9235aa938/package.json",
    "readmeFilename": "README.md",
    "readme": "# Beatrix JupyterLab\n\nThis directory contains the package for the customized build of JupyterLab\nsuitable for the Beatrix environment that it will run in. It is a self-contained\npackage independent of the package defined in the parent directory.\n\n## Development instructions\n\n### One-time setup\n\nThis only needs to be done once after cloning the repository.\n\n1. Ensure that [pipenv](https://pypi.org/project/pipenv/) is installed.\n\n1. Run the [initialize.sh](./initialize.sh) script which will install JupyterLab\n   in a local pipenv Python environment, install all NPM dependencies, compile\n   the extension, and install the `beatrix_jupyterlab` package, which provides\n   the necessary server routes used by the extension under the `/aipn/v2` path.\n\nYou are now ready to develop. Any changes you make to the frontend code should\nbe picked up by the steps indicated below in the development workflow section.\n\n### Normal development Workflow\n\nThe `BeatrixNotebookProviderPlugin` expects to be able to obtain VM metdata\nfrom the `/aipn/v2/metadata` route. If you're running on a Cloudtop, the\ninformation returned will not be consistent with what is expected to be\npresent on a Notebook Instance or Runtime. To avoid this, you can download\na valid metadata JSON file and serve it locally using the following steps.\n\n1. Use cURL to retrieve the metadata from an existing Notebook Instance or\n   Runtime that you have access to.\n\n   ```\n   curl -s https://<proxy host>/aipn/v2/metadata \\\n     -H \"Content-Type: application/json\" \\\n     -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\\n     | jq > vm_metadata.json\n   ```\n\n   - This will download the metadata from the Notebook to the `vm_metadata.json`\n     file needed in the next step.\n\n1. Run `npm run develop`. This will start three (3) concurrent processes.\n\n   - The TypeScript compiler to watch and recompile your sources\n   - A local Python server to serve the metadata JSON file\n     at http://localhost:8889. All requests to fetch VM metadata will be routed\n     here.\n   - The JupyterLab server at http://localhost:8888.\n\n## Generating a Python tarball\n\nRun the [build.sh](./build.sh) to generate a clean production build. This\ncommand will re-create the existing Pip environment and validate that the\nextension builds into JupyterLab. The end result will be a gzipped tarball\nof the Pip installable extension in the `dist/` folder.\n\n## Testing with Docker\n\nBuilding a Docker image is a good way to test behavior in a production-like\nenvironment. To do so, execute the following steps:\n\n1. Follow the instructions above in the Generating a Python tarball section.\n   Copy the tarball into the `docker` subdirectory and `cd` into it.\n   - `cp dist/beatrix_jupyterlab*.tar.gz docker/beatrix_jupyterlab.tar.gz && cd docker`\n1. Run `docker build . -t \"gcr.io/notebooks-frontend-playground/beatrix:latest\"`\n   - This will build a Docker image that installs the Beatrix extension into\n     the base DL container image.\n1. To test the image locally, do the following.\n\n   - Run `npm run metadata` to start a local metadata server.\n   - In another terminal, run the following:\n\n   ```\n   docker run --network host \\\n     -e 'METADATA_SERVER=http://localhost:8889' \\\n     gcr.io/notebooks-frontend-playground/beatrix:latest\n   ```\n\n1. You should now have the local metadata server running on port 8889 and the\n   Docker container running on port 8080. You should be able to access it\n   from your browser at http://localhost:8080 and proceed through the auth flow.\n1. If successful, you can push your image to [GCR](http://go/ccp-gcr/notebooks-frontend-playground/global/beatrix?project=notebooks-frontend-playground) using the following command:\n   - `docker push gcr.io/notebooks-frontend-playground/beatrix`\n   - This will make it available for use in semi-managed Notebooks as a Custom\n     Container.\n\n## Releasing\n\n1. Run the [prepare_release.py](./prepare_release.py) script and provide the\n   new version number.\n   - This will update the NPM package files, the Pip setup file, and the\n     release information TS file.\n1. Submit this change for review and ensure that it builds successfully on\n   Kokoro.\n1. Confirm that the build succeeds and verify that the `tar.gz` file copied to\n   Placer is valid and can be installed on a Notebook Instance or Runtime.\n   - Sample log:\n   ```\n   [15:21:22] Storing artifacts in placer\n   [15:21:23] Storing build artifacts to Placer\n   [15:21:28] Copied /tmp/workspace/workspace/caip_notebooks/gcp_ubuntu/presubmit/artifacts/git/beatrix/dist/beatrix_jupyterlab-0.0.4.tar.gz to /placer/prod/scratch/home/kokoro-dedicated/build_artifacts/prod/caip_notebooks/gcp_ubuntu/presubmit/522/20210722-151302/git/beatrix/dist/beatrix_jupyterlab-0.0.4.tar.gz\n   [15:21:28] Copied /tmp/workspace/workspace/caip_notebooks/gcp_ubuntu/presubmit/artifacts/git/beatrix/beatrix_jupyterlab-0.0.4.tgz to /placer/prod/scratch/home/kokoro-dedicated/build_artifacts/prod/caip_notebooks/gcp_ubuntu/presubmit/522/20210722-151302/git/beatrix/beatrix_jupyterlab-0.0.4.tgz\n   [15:21:28] Publishing scratchpad /placer/prod/scratch/home/kokoro-dedicated/build_artifacts/prod/caip_notebooks/gcp_ubuntu/presubmit/522/20210722-151302\n   [15:21:30] Result at placer: http://cnsviewer2/placer/prod/home/kokoro-dedicated/build_artifacts/prod/caip_notebooks/gcp_ubuntu/presubmit/522/20210722-151302\n   ```\n1. Merge the change into the `master` branch on http://go/beatrix-gob.\n1. Locally, do a `git pull` to ensure you've pulled down all changes from remote.\n1. Create a new tag for the version and push it to remote:\n   - ex.\n   ```\n   git tag v0.9.0 -m \"v0.9.0 public preview RC0\"\n   git push origin v0.0.4-rc0\n   ```\n1. Run a \"nightly\" Kokoro build from http://go/kkro/KOKORO/prod:caip_notebooks%2Fgcp_ubuntu%2Fnightly\n   specifying the tag you just pushed.\n   - [Screenshot](http://screen/3FPr3KPNqRE96Kn.png)\n1. Navigate to the Placer directory containing the built extension tarball.\n   - Click the Copy path action next to the `tar.gz` file in the `beatrix/dist`\n     folder ([Screenshot](http://screen/9dPMTCcLq8feWXg.png)).\n1. Back in your terminal, run the [./release.sh](./release.sh) script passing the Placer\n   path you copied in the previous step in as an argument.\n   - This will copy the tarball to [the location](http://screen/6XyQPpLVN6Ftuqk.png)\n     where the DLVM image build process will copy it.\n1. Get a reviewer from the DL Eng team and submit your change.\n1. Validate the correct behavior in the next morning's nightly Beatrix image.\n   - [deeplearning-platform Images page](<http://go/ccp-img?project=deeplearning-platform&pageState=(%22images%22:(%22s%22:%5B(%22i%22:%22creationTimestamp%22,%22s%22:%221%22),(%22i%22:%22type%22,%22s%22:%220%22),(%22i%22:%22name%22,%22s%22:%220%22)%5D,%22f%22:%22%255B%257B_22k_22_3A_22_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22beatrix_5C_22_22%257D%255D%22))>)\n\n## Server Extension\n\n`beatrix_jupyterlab` extends the Jupyter server with custom routes used by\nJupyterLab frontend extensions.\n\n### Normal development Workflow\n\n1. In order to access the metadata server running on GCE VM, you will need to\n   issue the following command to set up port forwarding. This will allow\n   requests made locally to port 8889 to be forwarded to a real GCE metadata\n   server. Do this in another terminal window since it will create a process\n   that needs to stay running.\n\n```\ngcloud compute ssh <instance> --zone <zone> \\\n  --ssh-flag \"-N -L 8889:metadata.google.internal:80\"\n```\n\n1. Then set the `METADATA_SERVER` environment variable to tell the server to use\n   the forwarded address.\n\n   `export METADATA_SERVER=\"http://localhost:8889\"`\n\n1. Run the [run.sh](./run.sh) to start the Jupyter server using `nodemon`.\n   This process will watch for changes in Python files and restart the server\n   afterwards.\n\n### Unit tests\n\nTo format, lint, and run Python unit tests, run `npm run pytest`.\n"
  },
  "artifacts": [],
  "remote": {
    "type": "copy",
    "resolved": "file:../extensions/beatrix_jupyterlab-3.1.7.tgz#00e704888beeb1490b54a310f68534b74c988dbf",
    "hash": "00e704888beeb1490b54a310f68534b74c988dbf",
    "registry": "npm",
    "reference": "/home/jupyter/.cache/yarn/v6/.tmp/3eeb0851228c5a858a1fe0d9235aa938"
  },
  "registry": "npm",
  "hash": "00e704888beeb1490b54a310f68534b74c988dbf"
}